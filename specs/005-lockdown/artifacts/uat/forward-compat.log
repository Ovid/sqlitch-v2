Forward compatibility harness (sqlitch â†’ sqitch)


============================================================
STEP: Step 1: Initialize Project
COMMAND: sqlitch init flipr --uri https://github.com/sqitchers/sqitch-sqlite-intro/ --engine sqlite
============================================================
Created sqitch.conf
Created sqitch.plan
Created deploy/
Created revert/
Created verify/

============================================================
STEP: Step 2: Configure User Name
COMMAND: sqitch config user.name Test User
============================================================


============================================================
STEP: Step 3: Configure User Email
COMMAND: sqlitch config user.email test@example.com
============================================================
Set user.email in local scope

============================================================
STEP: Step 4: Disable Pager
COMMAND: sqitch config --bool core.pager false
============================================================


============================================================
STEP: Step 5: Add 'users' Table
COMMAND: sqlitch add users -n Creates table to track our users.
============================================================
Created deploy/users.sql
Created revert/users.sql
Created verify/users.sql
Added "users" to sqitch.plan

============================================================
STEP: Step 6: Deploy 'users' Table
COMMAND: sqitch deploy db:sqlite:flipr_test.db
============================================================
Adding registry tables to db:sqlite:sqitch.db
Deploying changes to db:sqlite:flipr_test.db
  + users .. ok

============================================================
STEP: Step 7: Verify 'users' Deployment
COMMAND: sqlitch verify db:sqlite:flipr_test.db
============================================================
Verifying flipr_test
  * users .. ok
Verify successful

============================================================
STEP: Step 8: Check Status After Deploy
COMMAND: sqitch status db:sqlite:flipr_test.db
============================================================
# On database db:sqlite:flipr_test.db
# Project:  flipr
# Change:   [REDACTED_CHANGE_ID]
# Name:     users
# Deployed: 2025-10-11 21:20:17 +0200
# By:       Test User <test@example.com>
# 
Nothing to deploy (up-to-date)

============================================================
STEP: Step 9: Check DB Schema with sqlite3
COMMAND: sqlite3 flipr_test.db .tables
============================================================
users

============================================================
STEP: Step 10: Revert 'users' Table
COMMAND: sqitch revert db:sqlite:flipr_test.db -y
============================================================
Reverting all changes from db:sqlite:flipr_test.db
  - users .. ok

============================================================
STEP: Step 11: Verify Revert with sqlite3
COMMAND: sqlite3 flipr_test.db .tables
============================================================


============================================================
STEP: Step 12: Check Sqitch Log
COMMAND: sqitch log db:sqlite:flipr_test.db
============================================================
On database db:sqlite:flipr_test.db
Revert [REDACTED_CHANGE_ID]
Name:      users
Committer: Test User <test@example.com>
Date:      2025-10-11 21:20:SS +0200

    Creates table to track our users.

Deploy [REDACTED_CHANGE_ID]
Name:      users
Committer: Test User <test@example.com>
Date:      2025-10-11 21:20:SS +0200

    Creates table to track our users.


============================================================
STEP: Step 13: Add Target 'flipr_test'
COMMAND: sqlitch target add flipr_test db:sqlite:flipr_test.db
============================================================
Added target flipr_test

============================================================
STEP: Step 14: Add Engine for Target
COMMAND: sqitch engine add sqlite flipr_test
============================================================


============================================================
STEP: Step 15: Enable Deploy Verification
COMMAND: sqlitch config --bool deploy.verify true
============================================================
Set deploy.verify in local scope

============================================================
STEP: Step 16: Enable Rebase Verification
COMMAND: sqitch config --bool rebase.verify true
============================================================


============================================================
STEP: Step 17: Deploy Again with Target
COMMAND: sqlitch deploy
============================================================
Deploying plan 'flipr' to target 'db:sqlite:flipr_test.db'.
  + users
Deployment complete. Applied 1 change(s).

============================================================
STEP: Step 18: Add 'flips' Table
COMMAND: sqitch add flips --requires users -n Adds table for storing flips.
============================================================
Created deploy/flips.sql
Created revert/flips.sql
Created verify/flips.sql
Added "flips [users]" to sqitch.plan

============================================================
STEP: Step 19: Deploy 'flips' Table
COMMAND: sqlitch deploy
============================================================
Deploying plan 'flipr' to target 'db:sqlite:flipr_test.db'.
  + flips
Deployment complete. Applied 1 change(s).

============================================================
STEP: Step 20: Verify All Deployments
COMMAND: sqitch verify
============================================================
Verifying flipr_test
  * users .. ok
  * flips .. ok
Verify successful

============================================================
STEP: Step 21: Check DB Schema for 'users' and 'flips'
COMMAND: sqlite3 flipr_test.db .tables
============================================================
flips  users

============================================================
STEP: Step 22: Partial Revert to HEAD^
COMMAND: sqitch revert --to @HEAD^ -y
============================================================
Reverting changes to users from flipr_test
  - flips .. ok

============================================================
STEP: Step 23: Verify Partial Revert
COMMAND: sqlite3 flipr_test.db .tables
============================================================
users

============================================================
STEP: Step 24: Deploy All Again
COMMAND: sqitch deploy
============================================================
Deploying changes to flipr_test
  + flips .. ok

============================================================
STEP: Step 25: Add 'userflips' View
COMMAND: sqlitch add userflips --requires users --requires flips -n Creates the userflips view.
============================================================
Created deploy/userflips.sql
Created revert/userflips.sql
Created verify/userflips.sql
Added "userflips" to sqitch.plan

============================================================
STEP: Step 26: Deploy 'userflips' View
COMMAND: sqitch deploy
============================================================
Deploying changes to flipr_test
  + userflips .. ok

============================================================
STEP: Step 27: Full Revert
COMMAND: sqlitch revert -y
============================================================
Reverting all changes from flipr_test
  - userflips .. ok
  - flips .. ok
  - users .. ok

============================================================
STEP: Step 28: Full Redeploy
COMMAND: sqitch deploy
============================================================
Deploying changes to flipr_test
  + users ...... ok
  + flips ...... ok
  + userflips .. ok

============================================================
STEP: Step 29: Tag Release v1.0.0-dev1
COMMAND: sqlitch tag v1.0.0-dev1 -n Tag v1.0.0-dev1.
============================================================
Tagged userflips with @v1.0.0-dev1

============================================================
STEP: Step 30: Deploy Tag to New DB
COMMAND: sqitch deploy db:sqlite:dev/flipr.db
============================================================
Adding registry tables to db:sqlite:dev/sqitch.db
Deploying changes to db:sqlite:dev/flipr.db
  + users ................... ok
  + flips ................... ok
  + userflips @v1.0.0-dev1 .. ok

============================================================
STEP: Step 31: Check Status of Tagged DB
COMMAND: sqlitch status db:sqlite:dev/flipr.db
============================================================
# On database db:sqlite:dev/flipr.db
# Project:  flipr
# Change:   [REDACTED_CHANGE_ID]
# Name:     userflips
# Tag:      @v1.0.0-dev1
# Deployed: 2025-10-11 19:20:20.690
# By:       Test User <test@example.com>
# 
Nothing to deploy (up-to-date)

============================================================
STEP: Step 32: Create Bundle
COMMAND: sqitch bundle
============================================================
Bundling into bundle
Writing config
Writing plan
Writing scripts
  + users
  + flips
  + userflips @v1.0.0-dev1

============================================================
STEP: Step 33: Deploy Bundle to New DB
COMMAND: sqlitch deploy db:sqlite:flipr_prod.db -C bundle
============================================================
Deploying plan 'flipr' to target 'db:sqlite:flipr_prod.db'.
Nothing to deploy (up-to-date).

============================================================
STEP: Step 34: Add 'hashtags' Table
COMMAND: sqitch add hashtags --requires flips -n Adds table for storing hashtags.
============================================================
Created deploy/hashtags.sql
Created revert/hashtags.sql
Created verify/hashtags.sql
Added "hashtags [flips]" to sqitch.plan

============================================================
STEP: Step 35: Deploy 'hashtags' Table
COMMAND: sqlitch deploy
============================================================
Deploying plan 'flipr' to target 'db:sqlite:flipr_test.db'.
  + hashtags
Deployment complete. Applied 1 change(s).

============================================================
STEP: Step 36: Check Status with Tags
COMMAND: sqitch status --show-tags
============================================================
# On database flipr_test
# Project:  flipr
# Change:   [REDACTED_CHANGE_ID]
# Name:     hashtags
# Deployed: 2025-10-11 21:20:21 +0200
# By:       Test User <test@example.com>
# 
# Tag:
#   v1.0.0-dev1 - 2025-10-11 21:20:SS +0200 - Test User <test@example.com>
# 
Nothing to deploy (up-to-date)

============================================================
STEP: Step 37: Rebase Plan
COMMAND: sqlitch rebase -y
============================================================
Reverting all changes from flipr_test
  - hashtags .. ok
  - userflips .. ok
  - flips .. ok
  - users .. ok
Deploying plan 'flipr' to target 'db:sqlite:flipr_test.db'.
  + users
  + flips
  + userflips
  + hashtags
Deployment complete. Applied 4 change(s).

============================================================
STEP: Step 38: Tag Release v1.0.0-dev2
COMMAND: sqitch tag v1.0.0-dev2 -n Tag v1.0.0-dev2.
============================================================
Tagged "hashtags" with @v1.0.0-dev2 in sqitch.plan

============================================================
STEP: Step 39: Rework 'userflips' View
COMMAND: sqlitch rework userflips -n Adds userflips.twitter.
============================================================
Created rework deploy script deploy/userflips@v1.0.0-dev2.sql
Created rework revert script revert/userflips@v1.0.0-dev2.sql
Created rework verify script verify/userflips@v1.0.0-dev2.sql
Reworked userflips


============================================================
STEP: Step 40: Deploy Reworked View
COMMAND: sqitch deploy
============================================================
Deploying changes to flipr_test
  + userflips .. ok

============================================================
STEP: Step 41: Verify Reworked Schema
COMMAND: sqlite3 flipr_test.db .schema userflips
============================================================
CREATE VIEW userflips AS
SELECT f.id, u.nickname, u.fullname, u.twitter, f.body, f.timestamp
FROM users u
JOIN flips f ON u.nickname = f.nickname
/* userflips(id,nickname,fullname,twitter,body,timestamp) */;

============================================================
STEP: Step 42: Revert Reworked Change
COMMAND: sqitch revert --to @HEAD^ -y
============================================================
Reverting changes to hashtags @v1.0.0-dev2 from flipr_test
  - userflips .. ok

============================================================
STEP: Step 43: Verify Revert of Rework
COMMAND: sqlite3 flipr_test.db .schema userflips
============================================================
CREATE VIEW userflips AS
SELECT f.id, u.nickname, u.fullname, f.body, f.timestamp
FROM users u
JOIN flips f ON u.nickname = f.nickname
/* userflips(id,nickname,fullname,body,timestamp) */;

============================================================
STEP: Step 44: Final Deployment
COMMAND: sqitch deploy
============================================================
Deploying changes to flipr_test
  + userflips .. ok

============================================================
STEP: Step 45: Final Verification
COMMAND: sqlitch verify
============================================================
Verifying flipr_test
  * users .. ok
  * flips .. ok
  * userflips .. ok
  * hashtags .. ok
  * userflips .. ok
Verify successful

============================================================
STEP: Step 46: Final Status Check
COMMAND: sqitch status
============================================================
# On database flipr_test
# Project:  flipr
# Change:   [REDACTED_CHANGE_ID]
# Name:     userflips
# Deployed: 2025-10-11 21:20:22 +0200
# By:       Test User <test@example.com>
# 
Nothing to deploy (up-to-date)